# interstory drift ratio
interstory_drift = {
  'special_high_baseline': {
    'C1': {
      'slight': .006,
      'moderate': .013,
      'extensive': .038,
      'complete': .1
    },
    'C2': {
      'slight': .005,
      'moderate': .013,
      'extensive': .038,
      'complete': .1
    },
    'C3': {
      'slight': .003,
      'moderate': .006,
      'extensive': .015,
      'complete': .035
    },
    'MH': {
      'slight': .004,
      'moderate': .012,
      'extensive': .04,
      'complete': .1
    },
    'PC1': {
      'slight': .005,
      'moderate': .01,
      'extensive': .03,
      'complete': .088
    },
    'PC2': {
      'slight': .005,
      'moderate': .01,
      'extensive': .03,
      'complete': .088
    },
    'RM1': {
      'slight': .005,
      'moderate': .01,
      'extensive': .03,
      'complete': .088
    },
    'RM2': {
      'slight': .005,
      'moderate': .01,
      'extensive': .03,
      'complete': .088
    },
    'S1': {
      'slight': .008,
      'moderate': .015,
      'extensive': .038,
      'complete': .1 
    },
    'S2': {
      'slight': .006,
      'moderate': .013,
      'extensive': .038,
      'complete': .1 
    },
    'S3': {
      'slight': .005,
      'moderate': .01,
      'extensive': .03,
      'complete': .088 
    },
    'S4': {
      'slight': .005,
      'moderate': .01,
      'extensive': .03,
      'complete': .088
    },
    'S5': {
      'slight': .003,
      'moderate': .006,
      'extensive': .015,
      'complete': .035
    },
    'URM': {
      'slight': .003,
      'moderate': .006,
      'extensive': .015,
      'complete': .035
    },
    'W1': {
      'slight': .005,
      'moderate': .015,
      'extensive': .05,
      'complete': .125
    },
    'W1A': {
      'slight': .005,
      'moderate': .015,
      'extensive': .05,
      'complete': .125
    },
    'W2': {
      'slight': .005,
      'moderate': .015,
      'extensive': .05,
      'complete': .125
    }
  },
  'high_baseline': {
    'C1': {
      'slight': .005,
      'moderate': .01,
      'extensive': .03,
      'complete': .8
    },
    'C2': {
      'slight': .004,
      'moderate': .01,
      'extensive': .03,
      'complete': .8
    },
    'C3': {
      'slight': .003,
      'moderate': .006,
      'extensive': .015,
      'complete': .035
    },
    'MH': {
      'slight': .004,
      'moderate': .012,
      'extensive': .04,
      'complete': .1
    },
    'PC1': {
      'slight': .004,
      'moderate': .008,
      'extensive': .024,
      'complete': .07
    },
    'PC2': {
      'slight': .004,
      'moderate': .008,
      'extensive': .024,
      'complete': .07
    },
    'RM1': {
      'slight': .004,
      'moderate': .008,
      'extensive': .024,
      'complete': .07
    },
    'RM2': {
      'slight': .004,
      'moderate': .008,
      'extensive': .024,
      'complete': .07
    },
    'S1': {
      'slight': .006,
      'moderate': .012,
      'extensive': .03,
      'complete': .08
    },
    'S2': {
      'slight': .005,
      'moderate': .01,
      'extensive': .03,
      'complete': .08
    },
    'S3': {
      'slight': .004,
      'moderate': .008,
      'extensive': .024,
      'complete': .07 
    },
    'S4': {
      'slight': .004,
      'moderate': .008,
      'extensive': .024,
      'complete': .07
    },
    'S5': {
      'slight': .003,
      'moderate': .006,
      'extensive': .015,
      'complete': .035
    },
    'URM': {
      'slight': .003,
      'moderate': .006,
      'extensive': .015,
      'complete': .035
    },
    'W1': {
      'slight': .004,
      'moderate': .012,
      'extensive': .04,
      'complete': .1
    },
    'W1A': {
      'slight': .004,
      'moderate': .012,
      'extensive': .04,
      'complete': .1
    },
    'W2': {
      'slight': .004,
      'moderate': .012,
      'extensive': .04,
      'complete': .1
    }
  },
  'moderate_baseline': {
    'C1': {
      'slight': .005,
      'moderate': .009,
      'extensive': .023,
      'complete': .06
    },
    'C2': {
      'slight': .004,
      'moderate': .008,
      'extensive': .023,
      'complete': .06
    },
    'C3': {
      'slight': .003,
      'moderate': .006,
      'extensive': .015,
      'complete': .035
    },
    'MH': {
      'slight': .004,
      'moderate': .012,
      'extensive': .04,
      'complete': .1
    },
    'PC1': {
      'slight': .004,
      'moderate': .007,
      'extensive': .019,
      'complete': .053
    },
    'PC2': {
      'slight': .004,
      'moderate': .007,
      'extensive': .019,
      'complete': .053
    },
    'RM1': {
      'slight': .004,
      'moderate': .007,
      'extensive': .019,
      'complete': .053
    },
    'RM2': {
      'slight': .004,
      'moderate': .007,
      'extensive': .019,
      'complete': .053
    },
    'S1': {
      'slight': .006,
      'moderate': .01,
      'extensive': .024,
      'complete': .06
    },
    'S2': {
      'slight': .005,
      'moderate': .009,
      'extensive': .023,
      'complete': .06
    },
    'S3': {
      'slight': .004,
      'moderate': .007,
      'extensive': .019,
      'complete': .053
    },
    'S4': {
      'slight': .004,
      'moderate': .007,
      'extensive': .019,
      'complete': .053
    },
    'S5': {
      'slight': .003,
      'moderate': .006,
      'extensive': .015,
      'complete': .035
    },
    'URM': {
      'slight': .003,
      'moderate': .006,
      'extensive': .015,
      'complete': .035
    },
    'W1': {
      'slight': .004,
      'moderate': .01,
      'extensive': .031,
      'complete': .075
    },
    'W1A': {
      'slight': .004,
      'moderate': .01,
      'extensive': .031,
      'complete': .075
    },
    'W2': {
      'slight': .004,
      'moderate': .01,
      'extensive': .031,
      'complete': .075
    }
  },
  'high_poor': {
    'C1': {
      'slight': .005,
      'moderate': .009,
      'extensive': .023,
      'complete': .06
    },
    'C2': {
      'slight': .004,
      'moderate': .008,
      'extensive': .023,
      'complete': .06
    },
    'C3': {
      'slight': .003,
      'moderate': .006,
      'extensive': .015,
      'complete': .035
    },
    'MH': {
      'slight': .004,
      'moderate': .012,
      'extensive': .04,
      'complete': .1
    },
    'PC1': {
      'slight': .004,
      'moderate': .007,
      'extensive': .019,
      'complete': .053
    },
    'PC2': {
      'slight': .004,
      'moderate': .007,
      'extensive': .019,
      'complete': .053
    },
    'RM1': {
      'slight': .004,
      'moderate': .007,
      'extensive': .019,
      'complete': .053
    },
    'RM2': {
      'slight': .004,
      'moderate': .007,
      'extensive': .019,
      'complete': .053
    },
    'S1': {
      'slight': .006,
      'moderate': .01,
      'extensive': .024,
      'complete': .06
    },
    'S2': {
      'slight': .005,
      'moderate': .009,
      'extensive': .023,
      'complete': .06
    },
    'S3': {
      'slight': .004,
      'moderate': .007,
      'extensive': .019,
      'complete': .053
    },
    'S4': {
      'slight': .004,
      'moderate': .007,
      'extensive': .019,
      'complete': .053
    },
    'S5': {
      'slight': .003,
      'moderate': .006,
      'extensive': .015,
      'complete': .035
    },
    'URM': {
      'slight': .003,
      'moderate': .006,
      'extensive': .015,
      'complete': .035
    },
    'W1': {
      'slight': .004,
      'moderate': .01,
      'extensive': .031,
      'complete': .075
    },
    'W1A': {
      'slight': .004,
      'moderate': .01,
      'extensive': .031,
      'complete': .075
    },
    'W2': {
      'slight': .004,
      'moderate': .01,
      'extensive': .031,
      'complete': .075
    }
  },
  'low_baseline': {
    'C1': {
      'slight': .005,
      'moderate': .008,
      'extensive': .02,
      'complete': .05
    },
    'C2': {
      'slight': .004,
      'moderate': .008,
      'extensive': .02,
      'complete': .05
    },
    'C3': {
      'slight': .003,
      'moderate': .006,
      'extensive': .015,
      'complete': .035
    },
    'MH': {
      'slight': .004,
      'moderate': .012,
      'extensive': .04,
      'complete': .1
    },
    'PC1': {
      'slight': .004,
      'moderate': .006,
      'extensive': .016,
      'complete': .044
    },
    'PC2': {
      'slight': .004,
      'moderate': .006,
      'extensive': .016,
      'complete': .044
    },
    'RM1': {
      'slight': .004,
      'moderate': .006,
      'extensive': .016,
      'complete': .044
    },
    'RM2': {
      'slight': .004,
      'moderate': .006,
      'extensive': .016,
      'complete': .044
    },
    'S1': {
      'slight': .006,
      'moderate': .01,
      'extensive': .02,
      'complete': .05
    },
    'S2': {
      'slight': .005,
      'moderate': .008,
      'extensive': .02,
      'complete': .05
    },
    'S3': {
      'slight': .004,
      'moderate': .006,
      'extensive': .016,
      'complete': .044
    },
    'S4': {
      'slight': .004,
      'moderate': .006,
      'extensive': .016,
      'complete': .044
    },
    'S5': {
      'slight': .003,
      'moderate': .006,
      'extensive': .015,
      'complete': .035
    },
    'URM': {
      'slight': .003,
      'moderate': .006,
      'extensive': .015,
      'complete': .035
    },
    'W1': {
      'slight': .004,
      'moderate': .01,
      'extensive': .025,
      'complete': .06
    },
    'W1A': {
      'slight': .004,
      'moderate': .01,
      'extensive': .025,
      'complete': .06
    },
    'W2': {
      'slight': .004,
      'moderate': .01,
      'extensive': .025,
      'complete': .06
    },
  },
  'moderate_poor': {
    'C1': {
      'slight': .005,
      'moderate': .008,
      'extensive': .02,
      'complete': .05
    },
    'C2': {
      'slight': .004,
      'moderate': .008,
      'extensive': .02,
      'complete': .05
    },
    'C3': {
      'slight': .003,
      'moderate': .006,
      'extensive': .015,
      'complete': .035
    },
    'MH': {
      'slight': .004,
      'moderate': .012,
      'extensive': .04,
      'complete': .1
    },
    'PC1': {
      'slight': .004,
      'moderate': .006,
      'extensive': .016,
      'complete': .044
    },
    'PC2': {
      'slight': .004,
      'moderate': .006,
      'extensive': .016,
      'complete': .044
    },
    'RM1': {
      'slight': .004,
      'moderate': .006,
      'extensive': .016,
      'complete': .044
    },
    'RM2': {
      'slight': .004,
      'moderate': .006,
      'extensive': .016,
      'complete': .044
    },
    'S1': {
      'slight': .006,
      'moderate': .01,
      'extensive': .02,
      'complete': .05
    },
    'S2': {
      'slight': .005,
      'moderate': .008,
      'extensive': .02,
      'complete': .05
    },
    'S3': {
      'slight': .004,
      'moderate': .006,
      'extensive': .016,
      'complete': .044
    },
    'S4': {
      'slight': .004,
      'moderate': .006,
      'extensive': .016,
      'complete': .044
    },
    'S5': {
      'slight': .003,
      'moderate': .006,
      'extensive': .015,
      'complete': .035
    },
    'URM': {
      'slight': .003,
      'moderate': .006,
      'extensive': .015,
      'complete': .035
    },
    'W1': {
      'slight': .004,
      'moderate': .01,
      'extensive': .025,
      'complete': .06
    },
    'W1A': {
      'slight': .004,
      'moderate': .01,
      'extensive': .025,
      'complete': .06
    },
    'W2': {
      'slight': .004,
      'moderate': .01,
      'extensive': .025,
      'complete': .06
    }
  },
  'pre_baseline': {
    'C1': {
      'slight': .004,
      'moderate': .006,
      'extensive': .016,
      'complete': .04
    },
    'C2': {
      'slight': .003,
      'moderate': .006,
      'extensive': .016,
      'complete': .04
    },
    'C3': {
      'slight': .002,
      'moderate': .005,
      'extensive': .012,
      'complete': .028
    },
    'MH': {
      'slight': .004,
      'moderate': .012,
      'extensive': .04,
      'complete': .1
    },
    'PC1': {
      'slight': .003,
      'moderate': .005,
      'extensive': .013,
      'complete': .035
    },
    'PC2': {
      'slight': .003,
      'moderate': .005,
      'extensive': .013,
      'complete': .035
    },
    'RM1': {
      'slight': .003,
      'moderate': .005,
      'extensive': .013,
      'complete': .035
    },
    'RM2': {
      'slight': .003,
      'moderate': .005,
      'extensive': .013,
      'complete': .035
    },
    'S1': {
      'slight': .005,
      'moderate': .008,
      'extensive': .016,
      'complete': .04
    },
    'S2': {
      'slight': .004,
      'moderate': .006,
      'extensive': .016,
      'complete': .04
    },
    'S3': {
      'slight': .003,
      'moderate': .005,
      'extensive': .013,
      'complete': .035
    },
    'S4': {
      'slight': .003,
      'moderate': .005,
      'extensive': .013,
      'complete': .035
    },
    'S5': {
      'slight': .002,
      'moderate': .005,
      'extensive': .012,
      'complete': .028
    },
    'URM': {
      'slight': .002,
      'moderate': .005,
      'extensive': .012,
      'complete': .028
    },
    'W1': {
      'slight': .003,
      'moderate': .008,
      'extensive': .02,
      'complete': .05
    },
    'W1A': {
      'slight': .003,
      'moderate': .008,
      'extensive': .02,
      'complete': .05
    },
    'W2': {
      'slight': .003,
      'moderate': .008,
      'extensive': .02,
      'complete': .05
    }
  },
  'low_poor': {
    'C1': {
      'slight': .004,
      'moderate': .006,
      'extensive': .016,
      'complete': .04
    },
    'C2': {
      'slight': .003,
      'moderate': .006,
      'extensive': .016,
      'complete': .04
    },
    'C3': {
      'slight': .002,
      'moderate': .005,
      'extensive': .012,
      'complete': .028
    },
    'MH': {
      'slight': .004,
      'moderate': .012,
      'extensive': .04,
      'complete': .1
    },
    'PC1': {
      'slight': .003,
      'moderate': .005,
      'extensive': .013,
      'complete': .035
    },
    'PC2': {
      'slight': .003,
      'moderate': .005,
      'extensive': .013,
      'complete': .035
    },
    'RM1': {
      'slight': .003,
      'moderate': .005,
      'extensive': .013,
      'complete': .035
    },
    'RM2': {
      'slight': .003,
      'moderate': .005,
      'extensive': .013,
      'complete': .035
    },
    'S1': {
      'slight': .005,
      'moderate': .008,
      'extensive': .016,
      'complete': .04
    },
    'S2': {
      'slight': .004,
      'moderate': .006,
      'extensive': .016,
      'complete': .04
    },
    'S3': {
      'slight': .003,
      'moderate': .005,
      'extensive': .013,
      'complete': .035
    },
    'S4': {
      'slight': .003,
      'moderate': .005,
      'extensive': .013,
      'complete': .035
    },
    'S5': {
      'slight': .002,
      'moderate': .005,
      'extensive': .012,
      'complete': .028
    },
    'URM': {
      'slight': .002,
      'moderate': .005,
      'extensive': .012,
      'complete': .028
    },
    'W1': {
      'slight': .003,
      'moderate': .008,
      'extensive': .02,
      'complete': .05
    },
    'W1A': {
      'slight': .003,
      'moderate': .008,
      'extensive': .02,
      'complete': .05
    },
    'W2': {
      'slight': .003,
      'moderate': .008,
      'extensive': .02,
      'complete': .05
    }
  },
  'high_very_poor': {
    'C1': {
      'slight': .004,
      'moderate': .006,
      'extensive': .016,
      'complete': .04
    },
    'C2': {
      'slight': .003,
      'moderate': .006,
      'extensive': .016,
      'complete': .04
    },
    'C3': {
      'slight': .002,
      'moderate': .005,
      'extensive': .012,
      'complete': .028
    },
    'MH': {
      'slight': .004,
      'moderate': .012,
      'extensive': .04,
      'complete': .1
    },
    'PC1': {
      'slight': .003,
      'moderate': .005,
      'extensive': .013,
      'complete': .035
    },
    'PC2': {
      'slight': .003,
      'moderate': .005,
      'extensive': .013,
      'complete': .035
    },
    'RM1': {
      'slight': .003,
      'moderate': .005,
      'extensive': .013,
      'complete': .035
    },
    'RM2': {
      'slight': .003,
      'moderate': .005,
      'extensive': .013,
      'complete': .035
    },
    'S1': {
      'slight': .005,
      'moderate': .008,
      'extensive': .016,
      'complete': .04
    },
    'S2': {
      'slight': .004,
      'moderate': .006,
      'extensive': .016,
      'complete': .04
    },
    'S3': {
      'slight': .003,
      'moderate': .005,
      'extensive': .013,
      'complete': .035
    },
    'S4': {
      'slight': .003,
      'moderate': .005,
      'extensive': .013,
      'complete': .035
    },
    'S5': {
      'slight': .002,
      'moderate': .005,
      'extensive': .012,
      'complete': .028
    },
    'URM': {
      'slight': .002,
      'moderate': .005,
      'extensive': .012,
      'complete': .028
    },
    'W1': {
      'slight': .003,
      'moderate': .008,
      'extensive': .02,
      'complete': .05
    },
    'W1A': {
      'slight': .003,
      'moderate': .008,
      'extensive': .02,
      'complete': .05
    },
    'W2': {
      'slight': .003,
      'moderate': .008,
      'extensive': .02,
      'complete': .05
    }
  },
  'pre_poor': {
    'C1': {
      'slight': .004,
      'moderate': .006,
      'extensive': .012,
      'complete': .03
    },
    'C2': {
      'slight': .003,
      'moderate': .006,
      'extensive': .012,
      'complete': .03
    },
    'C3': {
      'slight': .002,
      'moderate': .005,
      'extensive': .008,
      'complete': .018
    },
    'MH': {
      'slight': .004,
      'moderate': .012,
      'extensive': .04,
      'complete': .1
    },
    'PC1': {
      'slight': .003,
      'moderate': .005,
      'extensive': .01,
      'complete': .027
    },
    'PC2': {
      'slight': .003,
      'moderate': .005,
      'extensive': .01,
      'complete': .027
    },
    'RM1': {
      'slight': .003,
      'moderate': .005,
      'extensive': .01,
      'complete': .027
    },
    'RM2': {
      'slight': .003,
      'moderate': .005,
      'extensive': .01,
      'complete': .027
    },
    'S1': {
      'slight': .005,
      'moderate': .008,
      'extensive': .012,
      'complete':.03 
    },
    'S2': {
      'slight': .004,
      'moderate': .006,
      'extensive': .012,
      'complete':.03 
    },
    'S3': {
      'slight': .003,
      'moderate': .005,
      'extensive': .01,
      'complete': .027 
    },
    'S4': {
      'slight': .003,
      'moderate': .005,
      'extensive': .01,
      'complete': .027
    },
    'S5': {
      'slight': .002,
      'moderate': .005,
      'extensive': .008,
      'complete': .018
    },
    'URM': {
      'slight': .002,
      'moderate': .005,
      'extensive': .008,
      'complete': .018
    },
    'W1': {
      'slight': .003,
      'moderate': .008,
      'extensive': .018,
      'complete': .045
    },
    'W1A': {
      'slight': .003,
      'moderate': .008,
      'extensive': .018,
      'complete': .045
    },
    'W2': {
      'slight': .003,
      'moderate': .008,
      'extensive': .018,
      'complete': .045
    },
  },
  'moderate_very_poor': {
    'C1': {
      'slight': .004,
      'moderate': .006,
      'extensive': .012,
      'complete': .03
    },
    'C2': {
      'slight': .003,
      'moderate': .006,
      'extensive': .012,
      'complete': .03
    },
    'C3': {
      'slight': .002,
      'moderate': .005,
      'extensive': .008,
      'complete': .018
    },
    'MH': {
      'slight': .004,
      'moderate': .012,
      'extensive': .04,
      'complete': .1
    },
    'PC1': {
      'slight': .003,
      'moderate': .005,
      'extensive': .01,
      'complete': .027
    },
    'PC2': {
      'slight': .003,
      'moderate': .005,
      'extensive': .01,
      'complete': .027
    },
    'RM1': {
      'slight': .003,
      'moderate': .005,
      'extensive': .01,
      'complete': .027
    },
    'RM2': {
      'slight': .003,
      'moderate': .005,
      'extensive': .01,
      'complete': .027
    },
    'S1': {
      'slight': .005,
      'moderate': .008,
      'extensive': .012,
      'complete':.03 
    },
    'S2': {
      'slight': .004,
      'moderate': .006,
      'extensive': .012,
      'complete':.03 
    },
    'S3': {
      'slight': .003,
      'moderate': .005,
      'extensive': .01,
      'complete': .027 
    },
    'S4': {
      'slight': .003,
      'moderate': .005,
      'extensive': .01,
      'complete': .027
    },
    'S5': {
      'slight': .002,
      'moderate': .005,
      'extensive': .008,
      'complete': .018
    },
    'URM': {
      'slight': .002,
      'moderate': .005,
      'extensive': .008,
      'complete': .018
    },
    'W1': {
      'slight': .003,
      'moderate': .008,
      'extensive': .018,
      'complete': .045
    },
    'W1A': {
      'slight': .003,
      'moderate': .008,
      'extensive': .018,
      'complete': .045
    },
    'W2': {
      'slight': .003,
      'moderate': .008,
      'extensive': .018,
      'complete': .045
    }
  },
  'low_very_poor': {
    'C1': {
      'slight': .004,
      'moderate': .006,
      'extensive': .01,
      'complete': .025
    },
    'C2': {
      'slight': .003,
      'moderate': .006,
      'extensive': .01,
      'complete': .025
    },
    'C3': {
      'slight': .002,
      'moderate': .005,
      'extensive': .008,
      'complete': .018
    },
    'MH': {
      'slight': .004,
      'moderate': .012,
      'extensive': .04,
      'complete': .1
    },
    'PC1': {
      'slight': .003,
      'moderate': .005,
      'extensive': .008,
      'complete': .022
    },
    'PC2': {
      'slight': .003,
      'moderate': .005,
      'extensive': .008,
      'complete': .022
    },
    'RM1': {
      'slight': .003,
      'moderate': .005,
      'extensive': .008,
      'complete': .022
    },
    'RM2': {
      'slight': .003,
      'moderate': .005,
      'extensive': .008,
      'complete': .022
    },
    'S1': {
      'slight': .005,
      'moderate': .008,
      'extensive': .01,
      'complete': .025
    },
    'S2': {
      'slight': .004,
      'moderate': .006,
      'extensive': .01,
      'complete': .025
    },
    'S3': {
      'slight': .003,
      'moderate': .005,
      'extensive': .008,
      'complete': .022
    },
    'S4': {
      'slight': .003,
      'moderate': .005,
      'extensive': .008,
      'complete': .022
    },
    'S5': {
      'slight': .002,
      'moderate': .005,
      'extensive': .008,
      'complete': .018
    },
    'URM': {
      'slight': .002,
      'moderate': .005,
      'extensive': .008,
      'complete': .018
    },
    'W1': {
      'slight': .003,
      'moderate': .008,
      'extensive': .015,
      'complete': .038
    },
    'W1A': {
      'slight': .003,
      'moderate': .008,
      'extensive': .015,
      'complete': .038
    },
    'W2': {
      'slight': .003,
      'moderate': .008,
      'extensive': .015,
      'complete': .038
    }
  },
  'pre_very_poor': {
    'C1': {
      'slight': .004,
      'moderate': .006,
      'extensive': .01,
      'complete': .02
    },
    'C2': {
      'slight': .003,
      'moderate': .006,
      'extensive': .01,
      'complete': .02
    },
    'C3': {
      'slight': .002,
      'moderate': .005,
      'extensive': .008,
      'complete': .014
    },
    'MH': {
      'slight': .004,
      'moderate': .012,
      'extensive': .04,
      'complete': .1
    },
    'PC1': {
      'slight': .003,
      'moderate': .005,
      'extensive': .008,
      'complete': .018
    },
    'PC2': {
      'slight': .003,
      'moderate': .005,
      'extensive': .008,
      'complete': .018
    },
    'RM1': {
      'slight': .003,
      'moderate': .005,
      'extensive': .008,
      'complete': .018
    },
    'RM2': {
      'slight': .003,
      'moderate': .005,
      'extensive': .008,
      'complete': .018
    },
    'S1': {
      'slight': .005,
      'moderate': .008,
      'extensive': .01,
      'complete': .02
    },
    'S2': {
      'slight': .004,
      'moderate': .006,
      'extensive': .01,
      'complete': .02
    },
    'S3': {
      'slight': .003,
      'moderate': .005,
      'extensive': .008,
      'complete': .018
    },
    'S4': {
      'slight': .003,
      'moderate': .005,
      'extensive': .008,
      'complete': .018
    },
    'S5': {
      'slight': .002,
      'moderate': .005,
      'extensive': .008,
      'complete': .014
    },
    'URM': {
      'slight': .002,
      'moderate': .005,
      'extensive': .008,
      'complete': .014
    },
    'W1': {
      'slight': .003,
      'moderate': .008,
      'extensive': .015,
      'complete': .03
    },
    'W1A': {
      'slight': .003,
      'moderate': .008,
      'extensive': .015,
      'complete': .03
    },
    'W2': {
      'slight': .003,
      'moderate': .008,
      'extensive': .015,
      'complete': .03
    }
  }
}

# modal weight factor
modal_weight = {
  1: {
    'S1': .75,
    'C1': .75,
    'PC1': .75,
    'URM': .75,
    'MH': 1.0,
    'other': .8
  },
  2: {
    'S1': .75,
    'C1': .75,
    'PC1': .75,
    'URM': .75,
    'other': .8
  },
  3: {
    'S1': .75,
    'C1': .75,
    'PC1': .75,
    'URM': .75,
    'MH': 1.0,
    'other': .8
  },
  4: {
    'S1': .75,
    'C1': .75,
    'MH': 1.0,
    'other': .8
  },
  5: {
    'S1': .75,
    'C1': .75,
    'MH': 1.0,
    'other': .8
  },
  6: {
    'S1': .73,
    'C1': .73,
    'other': .79
  },
  7: {
    'S1': .71,
    'C1': .71,
    'other': .78
  },
  8: {
    'S1': .69,
    'C1': .69,
    'other': .77
  },
  9: {
    'S1': .67,
    'C1': .67,
    'other': .76
  },
  10: {
    'S1': .65,
    'C1': .65,
    'other': .75
  },
  11: {
    'S1': .65,
    'C1': .65,
    'other': .75
  },
  12: {
    'S1': .65,
    'C1': .65,
    'other': .75
  },
  13: {
    'S1': .65,
    'C1': .65,
    'other': .75
  },
  14: {
    'S1': .65,
    'C1': .65,
    'other': .75
  },
  15: {
    'S1': .65,
    'C1': .65,
    'other': .75
  },
  100: {
    'S1': .65,
    'C1': .65,
    'other': .75
  },
}

# modal height factor
modal_height = {
  1: {
    'MH': 1.0,
    'other': .75
  },
  2: {
    'other': .75
  },
  3: {
    'other': .75
  },
  4: {
    'other': .75
  },
  5: {
    'other': .75
  },
  6: {
    'other': .72
  },
  7: {
    'other': .69
  },
  8: {
    'other': .66
  },
  9: {
    'other': .63
  },
  10: {
    'other': .60
  },
  11: {
    'other': .60
  },
  12: {
    'other': .60
  },
  13: {
    'other': .60
  },
  14: {
    'other': .60
  },
  15: {
    'other': .60
  },
  100: {
    'other': .60
  }
}

modal_shape_factor = {
    1: {
        'slight': 1.0,
        'moderate': 1.0,
        'extensive': None,
        'complete': None,
    },
    2: {
        'slight': 1.21,
        'moderate': 1.21,
        'extensive': None,
        'complete': None,
    },
    3: {
        'slight': 1.35,
        'moderate': 1.35,
        'extensive': None,
        'complete': None,
    },
    4: {
        'slight': 1.45,
        'moderate': 1.45,
        'extensive': None,
        'complete': None,
    },
    5: {
        'slight': 1.54,
        'moderate': 1.54,
        'extensive': None,
        'complete': None,
    },
    6: {
        'slight': 1.62,
        'moderate': 1.62,
        'extensive': None,
        'complete': None,
    },
    7: {
        'slight': 1.69,
        'moderate': 1.69,
        'extensive': None,
        'complete': None,
    },
    8: {
        'slight': 1.75,
        'moderate': 1.75,
        'extensive': None,
        'complete': None,
    },
    9: {
        'slight': 1.81,
        'moderate': 1.81,
        'extensive': None,
        'complete': None,
    },
    10: {
        'slight': 1.86,
        'moderate': 1.86,
        'extensive': None,
        'complete': None,
    },
    11: {
        'slight': 1.91,
        'moderate': 1.91,
        'extensive': None,
        'complete': None,
    },
    12: {
        'slight': 1.96,
        'moderate': 1.96,
        'extensive': None,
        'complete': None,
    },
    13: {
        'slight': 2.0,
        'moderate': 2.0,
        'extensive': None,
        'complete': None,
    },
    14: {
        'slight': 2.04,
        'moderate': 2.04,
        'extensive': None,
        'complete': None,
    },
    15: {
        'slight': 2.08,
        'moderate': 2.08,
        'extensive': None,
        'complete': None,
    },
    100: {
        'slight': 2.08,
        'moderate': 2.08,
        'extensive': None,
        'complete': None,
    },
}

def get_modal_response(mbt, bid, stories):
    complete = {}
    if mbt == 'W1' or mbt == 'W1a':
        if bid == 4 or bid == 6 or bid == 7:
            complete = {
                1: 1.00,
                2: 2.03,
                3: 2.50,
                4: 2.50,
                5: 2.50,
                6: 2.50,
                7: 2.50,
                8: 2.50,
                9: 2.50,
                10: 2.50,
                11: 2.50,
                12: 2.50,
                13: 2.50,
                14: 2.50,
                15: 2.50,
                100: 2.50
            }
        elif bid == 3 or bid == 5:
            complete = {
                1: 1.00,
                2: 1.62,
                3: 2.04,
                4: 2.36,
                5: 2.63,
                6: 2.87,
                7: 3.07,
                8: 3.26,
                9: 3.43,
                10: 3.59,
                11: 3.73,
                12: 3.87,
                13: 4.0,
                14: 4.0,
                15: 4.0,
                100: 4.0
            }
        else:
            complete = {
                1: 1.00,
                2: 1.62,
                3: 2.04,
                4: 2.36,
                5: 2.63,
                6: 2.87,
                7: 3.07,
                8: 3.26,
                9: 3.43,
                10: 3.59,
                11: 3.73,
                12: 3.87,
                13: 4.0,
                14: 4.12,
                15: 4.23,
                100: 4.23
            }
    elif bid == 1 or bid == 2:
        complete = {
            1: 1.00,
            2: 1.21,
            3: 1.35,
            4: 1.45,
            5: 1.54,
            6: 1.62,
            7: 1.69,
            8: 1.75,
            9: 1.81,
            10: 1.86,
            11: 1.91,
            12: 1.96,
            13: 2.0,
            14: 2.04,
            15: 2.08,
            100: 2.08
        }
    elif bid == 6 or bid == 7:
        complete = {
            1: 1.00,
            2: 2.03,
            3: 2.50,
            4: 2.50,
            5: 2.50,
            6: 2.50,
            7: 2.50,
            8: 2.50,
            9: 2.50,
            10: 2.50,
            11: 2.50,
            12: 2.50,
            13: 2.50,
            14: 2.50,
            15: 2.50,
            100: 2.50
        }
    elif bid == 4:
        complete = {
            1: 1.0,
            2: 2.03,
            3: 2.73,
            4: 3.27,
            5: 3.72,
            6: 4.0,
            7: 4.0,
            8: 4.0,
            9: 4.0,
            10: 4.0,
            11: 4.0,
            12: 4.0,
            13: 4.0,
            14: 4.0,
            15: 4.0,
            100: 4.0
        }
    else:
        complete = {
            1: 1.00,
            2: 1.62,
            3: 2.04,
            4: 2.36,
            5: 2.63,
            6: 2.87,
            7: 3.07,
            8: 3.26,
            9: 3.43,
            10: 3.59,
            11: 3.73,
            12: 3.87,
            13: 4.0,
            14: 4.0,
            15: 4.0,
            100: 4.0
        }

    shape = modal_shape_factor[stories]
    shape['complete'] = complete[stories]
    shape['extensive'] = (shape['slight'] + shape['complete']) / 2.0

    return shape

def get_drift(mbt, sdl, perf, state):
    '''
    =IF(OR(sdl="",mbt="",perf_rating=""),"",IF(AND(sdl="Special High",perf_rating="Baseline"),LOOKUP(mbt,$LP$5:$LP$21,$LS$5:$LS$21),IF(AND(sdl="High Code",perf_rating="Baseline"),LOOKUP(mbt,$LP$24:$LP$40,$LS$24:$LS$40),IF(OR(AND(sdl="Moderate Code",perf_rating="Baseline"),AND(sdl="High Code",perf_rating="Poor")),LOOKUP(mbt,$LP$43:$LP$59,$LS$43:$LS$59),IF(OR(AND(sdl="Low Code",perf_rating="Baseline"),AND(sdl="Moderate Code",perf_rating="Poor")),LOOKUP(mbt,$LP$62:$LP$78,$LS$62:$LS$78),IF(OR(AND(sdl="Pre-Code",perf_rating="Baseline"), AND(sdl="Low Code",perf_rating="Poor"),AND(sdl="High Code",perf_rating="Very Poor")),LOOKUP(mbt,$LP$81:$LP$97,$LS$81:$LS$97),IF(OR(AND(sdl="Pre-Code",perf_rating="Poor"),AND(sdl="Moderate Code",perf_rating="Very Poor")),LOOKUP(mbt,$LP$100:$LP$116,$LS$100:$LS$116),IF(AND(sdl="Low Code",perf_rating="Very Poor"),LOOKUP(mbt,$LP$119:$LP$135,$LS$119:$LS$135),LOOKUP(mbt,$LP$138:$LP$154,$LS$138:$LS$154)))))))))
    '''

    return interstory_drift['{}_{}'.format(sdl, perf)][mbt][state]

def get_modal_height(mbt, stories):
    return modal_height[stories].get(
        mbt,
        modal_height[stories].get('other', None)
    )

def get_modal_weight(mbt, stories):
    return modal_weight[stories].get(
        mbt,
        modal_weight[stories].get('other', None)
    )